{"ast":null,"code":"import _objectSpread from\"/Users/anbu/dev/scalp-app/desktop/src-tauri/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// =====================================================\n// API BASE RESOLUTION (SAFE & LAZY)\n// SINGLE SOURCE OF TRUTH\n// =====================================================\nfunction resolveApiBase(){console.log(\"[API] === resolveApiBase called ===\");console.log(\"[API] window.__SCALP_API_BASE__:\",window.__SCALP_API_BASE__);console.log(\"[API] window.__TAURI__:\",!!window.__TAURI__);// Desktop (Tauri injects this AFTER page load)\nif(typeof window!==\"undefined\"&&typeof window.__SCALP_API_BASE__===\"string\"){console.log(\"[API] âœ… Using injected base:\",window.__SCALP_API_BASE__);return window.__SCALP_API_BASE__;}// Tauri fallback\nif(typeof window!==\"undefined\"&&window.__TAURI__){console.log(\"[API] âœ… Tauri detected, using 47321\");return\"http://127.0.0.1:47321\";}// Browser dev fallback\nif(typeof window!==\"undefined\"){console.log(\"[API] âš ï¸ Browser fallback to 8000\");return\"http://127.0.0.1:8000\";}console.error(\"[API] âŒ No valid API base resolved\");return null;}// =====================================================\n// CORE API HELPER\n// =====================================================\nasync function api(path){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const API_BASE=resolveApiBase();const url=\"\".concat(API_BASE).concat(path);console.log(\"[API] â†’\",options.method||\"GET\",url);if(!API_BASE){throw new Error(\"API_BASE unresolved\");}const res=await fetch(url,_objectSpread(_objectSpread({},options),{},{headers:_objectSpread({\"Content-Type\":\"application/json\"},options.headers||{})}));console.log(\"[API] â†\",res.status,path);if(!res.ok){const txt=await res.text();console.error(\"[API] âŒ Error:\",txt);throw new Error(txt||\"API error \".concat(res.status));}const json=await res.json();console.log(\"[API] âœ“ Response:\",json);return json;}// =====================================================\n// SYSTEM STATUS\n// =====================================================\nexport const getStatus=async()=>{const s=await api(\"/status\");return{backend:s.backend,engine:s.engine,market:s.market,mode:s.mode,version:s.version};};// =====================================================\n// ZERODHA â€” SINGLE SOURCE OF TRUTH\n// =====================================================\n// ðŸ”’ Authoritative backend status\nexport const getZerodhaStatus=()=>api(\"/zerodha/status\");// ðŸ” Login URL\nexport const getZerodhaLoginUrl=()=>api(\"/zerodha/login-url\");// ðŸ”‘ Save credentials\nexport const saveZerodhaCredentials=(api_key,api_secret)=>api(\"/zerodha/configure\",{method:\"POST\",body:JSON.stringify({api_key,api_secret})});// â–¶ Enable / Disable trading\nexport const enableZerodhaTrading=()=>api(\"/zerodha/enable-trading\",{method:\"POST\"});export const disableZerodhaTrading=()=>api(\"/zerodha/disable-trading\",{method:\"POST\"});// =====================================================\n// STRATEGY CONFIG\n// =====================================================\nexport const getStrategyConfig=()=>api(\"/config/strategy\");export const saveStrategyConfig=config=>api(\"/config/strategy\",{method:\"POST\",body:JSON.stringify(config)});// =====================================================\n// TRADING / LOGS\n// =====================================================\nexport const getActiveTrade=async()=>{try{return await api(\"/trade/active\");}catch(_unused){return null;}};export const getLogs=async()=>{try{return await api(\"/logs\");}catch(_unused2){return[];}};// =====================================================\n// SELECTION / POSITIONS\n// =====================================================\nexport const getCurrentSelection=async()=>{try{return await api(\"/selection/current\");}catch(_unused3){return null;}};export const getTradeState=()=>api(\"/trade/state\");export const getTodayTrades=()=>api(\"/trades/today\");export const getTodayPositions=()=>api(\"/positions/today\");export const getLastSignals=()=>api(\"/signals/last\");// =====================================================\n// TRADE SIDE MODE\n// =====================================================\nexport const getTradeSideMode=()=>api(\"/api/trade_side_mode\");export const setTradeSideMode=mode=>api(\"/api/trade_side_mode\",{method:\"POST\",body:JSON.stringify({mode})});// =====================================================\n// LICENSE\n// =====================================================\nexport const getLicenseStatus=()=>api(\"/system/license\");","map":{"version":3,"names":["resolveApiBase","console","log","window","__SCALP_API_BASE__","__TAURI__","error","api","path","options","arguments","length","undefined","API_BASE","url","concat","method","Error","res","fetch","_objectSpread","headers","status","ok","txt","text","json","getStatus","s","backend","engine","market","mode","version","getZerodhaStatus","getZerodhaLoginUrl","saveZerodhaCredentials","api_key","api_secret","body","JSON","stringify","enableZerodhaTrading","disableZerodhaTrading","getStrategyConfig","saveStrategyConfig","config","getActiveTrade","_unused","getLogs","_unused2","getCurrentSelection","_unused3","getTradeState","getTodayTrades","getTodayPositions","getLastSignals","getTradeSideMode","setTradeSideMode","getLicenseStatus"],"sources":["/Users/anbu/dev/scalp-app/desktop/src-tauri/frontend/src/api.js"],"sourcesContent":["// =====================================================\n// API BASE RESOLUTION (SAFE & LAZY)\n// SINGLE SOURCE OF TRUTH\n// =====================================================\n\nfunction resolveApiBase() {\n  console.log(\"[API] === resolveApiBase called ===\");\n  console.log(\"[API] window.__SCALP_API_BASE__:\", window.__SCALP_API_BASE__);\n  console.log(\"[API] window.__TAURI__:\", !!window.__TAURI__);\n\n  // Desktop (Tauri injects this AFTER page load)\n  if (\n    typeof window !== \"undefined\" &&\n    typeof window.__SCALP_API_BASE__ === \"string\"\n  ) {\n    console.log(\"[API] âœ… Using injected base:\", window.__SCALP_API_BASE__);\n    return window.__SCALP_API_BASE__;\n  }\n\n  // Tauri fallback\n  if (typeof window !== \"undefined\" && window.__TAURI__) {\n    console.log(\"[API] âœ… Tauri detected, using 47321\");\n    return \"http://127.0.0.1:47321\";\n  }\n\n  // Browser dev fallback\n  if (typeof window !== \"undefined\") {\n    console.log(\"[API] âš ï¸ Browser fallback to 8000\");\n    return \"http://127.0.0.1:8000\";\n  }\n\n  console.error(\"[API] âŒ No valid API base resolved\");\n  return null;\n}\n\n// =====================================================\n// CORE API HELPER\n// =====================================================\n\nasync function api(path, options = {}) {\n  const API_BASE = resolveApiBase();\n  const url = `${API_BASE}${path}`;\n\n  console.log(\"[API] â†’\", options.method || \"GET\", url);\n\n  if (!API_BASE) {\n    throw new Error(\"API_BASE unresolved\");\n  }\n\n  const res = await fetch(url, {\n    ...options,\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...(options.headers || {}),\n    },\n  });\n\n  console.log(\"[API] â†\", res.status, path);\n\n  if (!res.ok) {\n    const txt = await res.text();\n    console.error(\"[API] âŒ Error:\", txt);\n    throw new Error(txt || `API error ${res.status}`);\n  }\n\n  const json = await res.json();\n  console.log(\"[API] âœ“ Response:\", json);\n  return json;\n}\n\n// =====================================================\n// SYSTEM STATUS\n// =====================================================\n\nexport const getStatus = async () => {\n  const s = await api(\"/status\");\n  return {\n    backend: s.backend,\n    engine: s.engine,\n    market: s.market,\n    mode: s.mode,\n    version: s.version,\n  };\n};\n\n// =====================================================\n// ZERODHA â€” SINGLE SOURCE OF TRUTH\n// =====================================================\n\n// ðŸ”’ Authoritative backend status\nexport const getZerodhaStatus = () =>\n  api(\"/zerodha/status\");\n\n// ðŸ” Login URL\nexport const getZerodhaLoginUrl = () =>\n  api(\"/zerodha/login-url\");\n\n// ðŸ”‘ Save credentials\nexport const saveZerodhaCredentials = (api_key, api_secret) =>\n  api(\"/zerodha/configure\", {\n    method: \"POST\",\n    body: JSON.stringify({ api_key, api_secret }),\n  });\n\n// â–¶ Enable / Disable trading\nexport const enableZerodhaTrading = () =>\n  api(\"/zerodha/enable-trading\", { method: \"POST\" });\n\nexport const disableZerodhaTrading = () =>\n  api(\"/zerodha/disable-trading\", { method: \"POST\" });\n\n// =====================================================\n// STRATEGY CONFIG\n// =====================================================\n\nexport const getStrategyConfig = () =>\n  api(\"/config/strategy\");\n\nexport const saveStrategyConfig = (config) =>\n  api(\"/config/strategy\", {\n    method: \"POST\",\n    body: JSON.stringify(config),\n  });\n\n// =====================================================\n// TRADING / LOGS\n// =====================================================\n\nexport const getActiveTrade = async () => {\n  try {\n    return await api(\"/trade/active\");\n  } catch {\n    return null;\n  }\n};\n\nexport const getLogs = async () => {\n  try {\n    return await api(\"/logs\");\n  } catch {\n    return [];\n  }\n};\n\n// =====================================================\n// SELECTION / POSITIONS\n// =====================================================\n\nexport const getCurrentSelection = async () => {\n  try {\n    return await api(\"/selection/current\");\n  } catch {\n    return null;\n  }\n};\n\nexport const getTradeState = () =>\n  api(\"/trade/state\");\n\nexport const getTodayTrades = () =>\n  api(\"/trades/today\");\n\nexport const getTodayPositions = () =>\n  api(\"/positions/today\");\n\nexport const getLastSignals = () =>\n  api(\"/signals/last\");\n\n// =====================================================\n// TRADE SIDE MODE\n// =====================================================\n\nexport const getTradeSideMode = () =>\n  api(\"/api/trade_side_mode\");\n\nexport const setTradeSideMode = (mode) =>\n  api(\"/api/trade_side_mode\", {\n    method: \"POST\",\n    body: JSON.stringify({ mode }),\n  });\n\n// =====================================================\n// LICENSE\n// =====================================================\n\nexport const getLicenseStatus = () =>\n  api(\"/system/license\");\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}