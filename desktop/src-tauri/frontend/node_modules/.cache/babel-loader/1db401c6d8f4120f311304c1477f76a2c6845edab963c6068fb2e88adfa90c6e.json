{"ast":null,"code":"import _objectSpread from\"/Users/anbu/dev/scalp-app/desktop/src-tauri/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useEffect,useState,useMemo,useRef}from\"react\";import{getTradeState,getZerodhaStatus,getActiveTrade,getLogs,getCurrentSelection,getStatus,getTodayTrades,getTodayPositions,getStrategyConfig}from\"../api\";import{getTradeSideMode,setTradeSideMode}from\"../api\";import DebugPanel from\"../components/DebugPanel\";import{LoadingAnimations,FullPageLoader,EmptyState,TableSkeleton,CardSkeleton}from\"../components/LoadingStates\";import{useToast}from\"../components/ToastNotifications\";import{Sparkline,PriceChangeIndicator,ProgressBar,PriceWithSparkline,PnLTrendArrow}from\"../components/DataVisualization\";import{exportToCSV,formatTradesForExport,generateFilename}from\"../utils/export\";import{getApiBase}from\"../api/base\";// BOOTING | UP | DOWN\n/* ----------------------------------\n   Typography & Spacing Tokens\n----------------------------------- */import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const spacing={xs:4,sm:8,md:12,lg:16,xl:20,xxl:24};const typography={displayLarge:{fontSize:28,fontWeight:700,lineHeight:1.2},displaySmall:{fontSize:24,fontWeight:600,lineHeight:1.3},headingLarge:{fontSize:18,fontWeight:600,lineHeight:1.4},headingMedium:{fontSize:16,fontWeight:600,lineHeight:1.4},headingSmall:{fontSize:14,fontWeight:600,lineHeight:1.4},bodyLarge:{fontSize:14,fontWeight:400,lineHeight:1.5},bodyMedium:{fontSize:13,fontWeight:400,lineHeight:1.5},bodySmall:{fontSize:12,fontWeight:400,lineHeight:1.4},label:{fontSize:11,fontWeight:500,lineHeight:1.3,letterSpacing:'0.5px',textTransform:'uppercase'},mono:{fontFamily:\"'JetBrains Mono', 'Fira Code', monospace\",fontVariantNumeric:\"tabular-nums\"}};const colors={profit:\"#10b981\",profitBg:\"rgba(16, 185, 129, 0.12)\",loss:\"#ef4444\",lossBg:\"rgba(239, 68, 68, 0.12)\",neutral:\"#6b7280\",primary:\"#3b82f6\",primaryBg:\"rgba(59, 130, 246, 0.12)\",success:\"#10b981\",successBg:\"rgba(16, 185, 129, 0.15)\",warning:\"#f59e0b\",warningBg:\"rgba(245, 158, 11, 0.15)\",danger:\"#ef4444\",dangerBg:\"rgba(239, 68, 68, 0.15)\",bg:{primary:\"#0a0f1e\",secondary:\"#111827\",tertiary:\"#1f2937\",elevated:\"#374151\"},border:{light:\"#374151\",medium:\"#4b5563\",dark:\"#1f2937\"},text:{primary:\"#f9fafb\",secondary:\"#d1d5db\",tertiary:\"#9ca3af\",muted:\"#6b7280\"}};const ACTIVE_STATES=[\"BUY_PLACED\",\"PROTECTED\",\"BUY_FILLED\",\"IN_TRADE\"];/* ----------------------------------\n   Audio Alert System\n----------------------------------- */const AudioAlerts={context:null,init(){if(!this.context&&typeof window!=='undefined'){this.context=new(window.AudioContext||window.webkitAudioContext)();}},playTone(frequency,duration){let type=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'sine';this.init();if(!this.context)return;const oscillator=this.context.createOscillator();const gainNode=this.context.createGain();oscillator.connect(gainNode);gainNode.connect(this.context.destination);oscillator.frequency.value=frequency;oscillator.type=type;gainNode.gain.setValueAtTime(0.3,this.context.currentTime);gainNode.gain.exponentialRampToValueAtTime(0.01,this.context.currentTime+duration);oscillator.start(this.context.currentTime);oscillator.stop(this.context.currentTime+duration);},// New position entered\npositionEntered(){this.playTone(800,0.15);setTimeout(()=>this.playTone(1000,0.15),150);},// Stop loss hit\nstopLossHit(){this.playTone(400,0.2);setTimeout(()=>this.playTone(350,0.2),200);setTimeout(()=>this.playTone(300,0.3),400);},// Take profit hit\ntakeProfitHit(){this.playTone(600,0.1);setTimeout(()=>this.playTone(800,0.1),100);setTimeout(()=>this.playTone(1000,0.15),200);}};/* ----------------------------------\n   Small helpers\n----------------------------------- */function normalizeSymbol(sym){if(!sym)return sym;return sym.replace(/\\s+/g,\"\").toUpperCase();}function StatusBadge(_ref){let{ok,text,warn,danger,icon}=_ref;let bg=colors.dangerBg;let color=colors.danger;let borderColor=colors.danger;if(ok){bg=colors.successBg;color=colors.success;borderColor=colors.success;}else if(danger){bg=colors.dangerBg;color=colors.danger;borderColor=colors.danger;}else if(warn){bg=colors.warningBg;color=colors.warning;borderColor=colors.warning;}return/*#__PURE__*/_jsxs(\"span\",{style:_objectSpread(_objectSpread({padding:\"4px 10px\",borderRadius:6},typography.bodySmall),{},{fontWeight:600,background:bg,color,border:\"1px solid \".concat(borderColor,\"40\"),display:\"inline-flex\",alignItems:\"center\",gap:4,minWidth:\"90px\",justifyContent:\"center\",textTransform:\"uppercase\",letterSpacing:\"0.3px\"}),children:[icon&&/*#__PURE__*/_jsx(\"span\",{style:{fontSize:10},children:icon}),text]});}const safeNum=v=>typeof v===\"number\"&&!isNaN(v)?v:0;const pnlStyle=v=>({color:v>0?colors.profit:v<0?colors.loss:colors.neutral,fontWeight:600});const formatTimestamp=timestamp=>{if(!timestamp)return\"â€”\";const date=new Date(timestamp);const today=new Date();const isToday=date.getDate()===today.getDate()&&date.getMonth()===today.getMonth()&&date.getFullYear()===today.getFullYear();if(isToday){return date.toLocaleTimeString('en-IN',{hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:false});}else{return date.toLocaleString('en-IN',{year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit',hour12:false});}};/* ----------------------------------\n   Card Component\n----------------------------------- */function Card(_ref2){let{children,style,elevated}=_ref2;return/*#__PURE__*/_jsx(\"div\",{style:_objectSpread({background:elevated?colors.bg.tertiary:colors.bg.secondary,border:\"1px solid \".concat(colors.border.light),borderRadius:8,boxShadow:elevated?\"0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2)\":\"0 1px 3px rgba(0, 0, 0, 0.2)\"},style),children:children});}/* ----------------------------------\n   Dashboard\n----------------------------------- */export default function Dashboard(){const toast=useToast();const[zerodha,setZerodha]=useState(null);const[status,setStatus]=useState(null);const[trade,setTrade]=useState(null);const[logs,setLogs]=useState([]);const[selection,setSelection]=useState(null);const[tradeState,setTradeState]=useState(null);const[tradeSideMode,setTradeSideModeState]=useState(\"BOTH\");const[strategyConfig,setStrategyConfig]=useState(null);const[indices,setIndices]=useState({});const[loading,setLoading]=useState(true);const[backendHealth,setBackendHealth]=useState(\"BOOTING\");const[booting,setBooting]=useState(true);const[positions,setPositions]=useState({open:[],closed:[],totals:{realised:0,unrealised:0,total:0}});const[ltpMap,setLtpMap]=useState({});const[prevTradeState,setPrevTradeState]=useState(null);const[positionsLoading,setPositionsLoading]=useState(true);// Track price history for sparklines\nconst[priceHistory,setPriceHistory]=useState({});const[pnlHistory,setPnlHistory]=useState({});// Add this inside Dashboard component, after the useEffect\nuseEffect(()=>{console.log('[DEBUG] Window.__SCALP_API_BASE__:',window.__SCALP_API_BASE__);console.log('[DEBUG] Window.__TAURI__:',window.__TAURI__);console.log('[DEBUG] Resolved API base:',getApiBase());},[]);// Update price history when LTP changes\nuseEffect(()=>{if(ltpMap&&Object.keys(ltpMap).length>0){setPriceHistory(prev=>{const updated=_objectSpread({},prev);Object.entries(ltpMap).forEach(_ref3=>{let[symbol,price]=_ref3;if(typeof price==='number'){if(!updated[symbol]){updated[symbol]=[];}// Keep last 30 data points for sparkline\nupdated[symbol]=[...updated[symbol],price].slice(-30);}});return updated;});}},[ltpMap]);// Update PnL history when trade state or LTP changes\nuseEffect(()=>{if(!tradeState||!ltpMap||Object.keys(ltpMap).length===0)return;setPnlHistory(prev=>{const updated=_objectSpread({},prev);let hasChanges=false;Object.entries(tradeState).forEach(_ref4=>{let[slot,state]=_ref4;if(!state||typeof state!=='object')return;const symbol=state.symbol;if(!symbol||!ACTIVE_STATES.includes(state.state))return;const liveLtp=ltpMap[symbol];const buyPrice=state.buy_price;const qty=state.qty;if(typeof buyPrice==='number'&&typeof liveLtp==='number'&&typeof qty==='number'){const pnl=(liveLtp-buyPrice)*qty;if(!updated[symbol]){updated[symbol]=[];}// Only add if different from last value\nconst lastPnl=updated[symbol][updated[symbol].length-1];if(lastPnl!==pnl){updated[symbol]=[...updated[symbol],pnl].slice(-10);hasChanges=true;}}});return hasChanges?updated:prev;});},[tradeState,ltpMap]);// Track previous states for audio alerts and toast notifications\nuseEffect(()=>{if(!tradeState||!prevTradeState){setPrevTradeState(tradeState);return;}// Check for state changes\nObject.entries(tradeState).forEach(_ref5=>{let[slot,currentState]=_ref5;const prevState=prevTradeState[slot];if(!prevState||!currentState)return;const curr=typeof currentState==='object'?currentState.state:currentState;const prev=typeof prevState==='object'?prevState.state:prevState;// Skip if no actual state change\nif(curr===prev)return;// Get symbol for notification\nconst symbol=typeof currentState==='object'?currentState.symbol:slot;const price=typeof currentState==='object'?currentState.buy_price:null;const pnl=typeof currentState==='object'?currentState.realized_pnl||currentState.pnl:null;console.log(\"State change detected: \".concat(slot,\" \").concat(prev,\" -> \").concat(curr,\" (\").concat(symbol,\")\"));// New position entered (ARMED -> BUY_PLACED, BUY_FILLED, PROTECTED, or IN_TRADE)\nif(prev==='ARMED'&&(curr==='BUY_PLACED'||curr==='BUY_FILLED'||curr==='PROTECTED'||curr==='IN_TRADE')){console.log('ðŸ”Š Position entered alert');AudioAlerts.positionEntered();const priceStr=price?\" @ \\u20B9\".concat(price.toFixed(2)):'';toast.info(\"Position Entered\",\"\".concat(symbol).concat(priceStr),{duration:4000});}// Position exited - check multiple exit states\nif(ACTIVE_STATES.includes(prev)&&(curr==='SL_HIT'||curr==='TP_HIT'||curr==='EXITED'||curr==='CLOSED')){console.log(\"\\uD83D\\uDD0A Position exit alert: \".concat(curr));const pnlStr=pnl?\" \".concat(pnl>0?'+':'',\"\\u20B9\").concat(Math.round(pnl).toLocaleString('en-IN')):'';if(curr==='SL_HIT'){AudioAlerts.stopLossHit();toast.error(\"Stop Loss Hit\",\"\".concat(symbol).concat(pnlStr),{duration:6000});}else if(curr==='TP_HIT'){AudioAlerts.takeProfitHit();toast.success(\"Target Reached\",\"\".concat(symbol).concat(pnlStr,\" \\uD83C\\uDF89\"),{duration:6000,icon:\"ðŸŽ¯\"});}else{// Generic exit (EXITED/CLOSED)\nif(pnl&&pnl>0){AudioAlerts.takeProfitHit();toast.success(\"Position Closed\",\"\".concat(symbol).concat(pnlStr),{duration:5000});}else{AudioAlerts.stopLossHit();toast.warning(\"Position Closed\",\"\".concat(symbol).concat(pnlStr),{duration:5000});}}}});setPrevTradeState(tradeState);},[tradeState,toast]);useEffect(()=>{async function initialLoad(){await loadFast();await loadSlow();setLoading(false);}initialLoad();const fast=setInterval(loadFast,3000);const slow=setInterval(loadSlow,15000);return()=>{clearInterval(fast);clearInterval(slow);};},[]);useEffect(()=>{let alive=true;async function pollLtp(){while(alive){try{const res=await fetch(\"\".concat(getApiBase(),\"/ltp_snapshot\"));if(res.ok){const data=await res.json();if(data&&typeof data===\"object\"){// Normalize all keys before storing\nconst normalized={};Object.entries(data).forEach(_ref6=>{let[symbol,price]=_ref6;normalized[normalizeSymbol(symbol)]=price;});setLtpMap(normalized);}}}catch(_unused){}await new Promise(r=>setTimeout(r,500));}}pollLtp();return()=>{alive=false;};},[]);useEffect(()=>{let alive=true;async function pollIndices(){while(alive){try{const res=await fetch(\"\".concat(getApiBase(),\"/market_indices\"));if(res.ok){const data=await res.json();if(data&&typeof data===\"object\"){setIndices(data);}}}catch(_unused2){}await new Promise(r=>setTimeout(r,500));}}pollIndices();return()=>{alive=false;};},[]);async function loadFast(){// ---- DEBUG: Check API base ----\nconsole.log('[DEBUG] === loadFast called ===');console.log('[DEBUG] window.__SCALP_API_BASE__:',window.__SCALP_API_BASE__);console.log('[DEBUG] window.__TAURI__:',!!window.__TAURI__);try{const apiBase=getApiBase();console.log('[DEBUG] getApiBase() returned:',apiBase);}catch(e){console.error('[DEBUG] getApiBase() error:',e);}// ---- BACKEND / ENGINE STATUS ----\ntry{const statusUrl=\"\".concat(getApiBase(),\"/status\");console.log('[DEBUG] Fetching status from:',statusUrl);const s=await getStatus();console.log('[DEBUG] Status response:',JSON.stringify(s,null,2));setStatus(s);if((s===null||s===void 0?void 0:s.backend)===\"UP\"){console.log('[DEBUG] âœ… Backend is UP, setting health to UP');setBackendHealth(\"UP\");setBooting(false);}else{console.log('[DEBUG] âŒ Backend not UP, status.backend =',s===null||s===void 0?void 0:s.backend);setBackendHealth(\"DOWN\");}}catch(error){console.error('[DEBUG] âŒ Error fetching status:',error);console.error('[DEBUG] Error message:',error.message);console.error('[DEBUG] Error stack:',error.stack);setBackendHealth(prev=>{console.log('[DEBUG] Setting backend health, prev was:',prev);return prev===\"UP\"?\"DOWN\":prev;});}// ---- REST ----\ntry{const trade=await getActiveTrade();console.log('[DEBUG] Active trade:',trade);setTrade(trade);}catch(e){console.error('[DEBUG] getActiveTrade error:',e);}try{const tradeState=await getTradeState();console.log('[DEBUG] Trade state:',tradeState);setTradeState(tradeState);}catch(e){console.error('[DEBUG] getTradeState error:',e);}try{const selection=await getCurrentSelection();console.log('[DEBUG] Current selection:',selection);setSelection(selection);}catch(e){console.error('[DEBUG] getCurrentSelection error:',e);}}async function loadSlow(){try{setZerodha(await getZerodhaStatus());}catch(_unused3){}try{setStrategyConfig(await getStrategyConfig());}catch(_unused4){}try{const l=await getLogs();setLogs(Array.isArray(l)?l:(l===null||l===void 0?void 0:l.logs)||[]);}catch(_unused5){}try{setPositionsLoading(true);const p=await getTodayPositions();const open=(p===null||p===void 0?void 0:p.open)||[];const closed=(p===null||p===void 0?void 0:p.closed)||[];const realised=closed.reduce((s,x)=>s+safeNum(x.pnl),0);const unrealised=open.reduce((s,x)=>s+safeNum(x.pnl),0);setPositions({open,closed,totals:{realised,unrealised,total:realised+unrealised}});}catch(_unused6){setPositions({open:[],closed:[],totals:{realised:0,unrealised:0,total:0}});}finally{setPositionsLoading(false);}try{const res=await getTradeSideMode();setTradeSideModeState((res===null||res===void 0?void 0:res.mode)||\"BOTH\");}catch(_unused7){}}const symbolToSlot={};if(tradeState){Object.entries(tradeState).forEach(_ref7=>{let[slot,data]=_ref7;if(data&&typeof data===\"object\"&&data.symbol){symbolToSlot[data.symbol]=slot;}});}const activeTradeBySymbol=useMemo(()=>{if(!tradeState)return{};const map={};Object.entries(tradeState).forEach(_ref8=>{let[slot,t]=_ref8;if(t&&typeof t===\"object\"&&t.symbol){map[t.symbol]=_objectSpread(_objectSpread({},t),{},{slot});}});return map;},[tradeState]);const rows=[];if(selection){if(tradeSideMode!==\"PE\"){(selection.CE||[]).forEach((o,i)=>rows.push(_objectSpread(_objectSpread({},o),{},{side:\"CE\",idx:i+1,slot:symbolToSlot[o.tradingsymbol]||\"CE_\".concat(i+1)})));}if(tradeSideMode!==\"CE\"){(selection.PE||[]).forEach((o,i)=>rows.push(_objectSpread(_objectSpread({},o),{},{side:\"PE\",idx:i+1,slot:symbolToSlot[o.tradingsymbol]||\"PE_\".concat(i+1)})));}}const tradingEnabled=(strategyConfig===null||strategyConfig===void 0?void 0:strategyConfig.trade_on)===true;const executionMode=(strategyConfig===null||strategyConfig===void 0?void 0:strategyConfig.trade_execution_mode)||\"LIVE\";const inTrade=tradeState&&Object.values(tradeState).some(v=>typeof v===\"object\"?ACTIVE_STATES.includes(v.state):v===\"IN_TRADE\");// Export handler\nfunction handleExportTrades(){const allPositions=[...positions.open,...positions.closed];if(allPositions.length===0){toast.warning('No Data','No trades to export');return;}const formattedTrades=formatTradesForExport(allPositions);exportToCSV(formattedTrades,generateFilename('today_trades','csv'));toast.success('Export Complete',\"\".concat(allPositions.length,\" trades exported\"));}if(loading){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(LoadingAnimations,{}),/*#__PURE__*/_jsx(FullPageLoader,{message:\"Loading dashboard...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{style:{padding:spacing.xxl,background:colors.bg.primary,color:colors.text.primary,minHeight:\"100vh\",fontFamily:\"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif\"},children:[loading&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"fixed\",top:0,left:0,right:0,height:2,background:colors.border.dark,zIndex:1000},children:/*#__PURE__*/_jsx(\"div\",{style:{height:\"100%\",background:\"linear-gradient(90deg, \".concat(colors.primary,\", \").concat(colors.success,\")\"),animation:\"loading 1.5s ease-in-out infinite\",width:\"40%\"}})}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:spacing.xxl},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",justifyContent:\"space-between\",marginBottom:spacing.lg},children:[/*#__PURE__*/_jsx(\"h1\",{style:_objectSpread(_objectSpread({margin:0},typography.displayLarge),{},{color:colors.text.primary}),children:\"Scalp Terminal\"}),/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},typography.label),{},{color:colors.text.muted}),children:\"Live Trading Dashboard\"})]}),/*#__PURE__*/_jsx(Card,{elevated:true,style:{padding:spacing.md,marginBottom:spacing.lg},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",justifyContent:\"space-between\",flexWrap:\"wrap\",gap:spacing.md},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",gap:spacing.md,flexWrap:\"wrap\"},children:[/*#__PURE__*/_jsx(StatusBadge,{ok:zerodha===null||zerodha===void 0?void 0:zerodha.connected,danger:!(zerodha!==null&&zerodha!==void 0&&zerodha.connected),text:zerodha!==null&&zerodha!==void 0&&zerodha.connected?\"Connected\":\"Disconnected\",icon:zerodha!==null&&zerodha!==void 0&&zerodha.connected?\"â—\":\"â—‹\"}),/*#__PURE__*/_jsx(StatusBadge,{ok:backendHealth===\"UP\"&&(status===null||status===void 0?void 0:status.engine)===\"RUNNING\",warn:backendHealth===\"BOOTING\",danger:backendHealth===\"DOWN\",text:backendHealth===\"BOOTING\"?\"Backend Starting\":backendHealth===\"DOWN\"?\"Backend Down\":(status===null||status===void 0?void 0:status.engine)===\"RUNNING\"?\"Engine Running\":\"Engine Paused\",icon:\"\\u26A1\"}),/*#__PURE__*/_jsx(StatusBadge,{ok:tradingEnabled,warn:!tradingEnabled,text:tradingEnabled?\"Trading\":\"Paused\",icon:tradingEnabled?\"â–¶\":\"â¸\"}),/*#__PURE__*/_jsx(StatusBadge,{ok:executionMode===\"LIVE\",warn:executionMode===\"PAPER\",text:executionMode,icon:executionMode===\"LIVE\"?\"ðŸŸ¢\":\"ðŸ§ª\"}),/*#__PURE__*/_jsx(StatusBadge,{ok:inTrade,warn:!inTrade,text:inTrade?\"In Trade\":\"Armed\",icon:inTrade?\"ðŸŽ¯\":\"âšª\"}),/*#__PURE__*/_jsx(MarketBadge,{name:\"NIFTY\",data:indices.NIFTY}),/*#__PURE__*/_jsx(MarketBadge,{name:\"BANKNIFTY\",data:indices.BANKNIFTY}),/*#__PURE__*/_jsx(\"div\",{style:{flex:1}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",gap:spacing.lg,flexWrap:\"wrap\"},children:[/*#__PURE__*/_jsx(\"span\",{style:_objectSpread(_objectSpread({},typography.bodySmall),{},{color:colors.text.muted,fontWeight:500}),children:\"MODE:\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",gap:4,background:colors.bg.primary,padding:4,borderRadius:6},children:[\"BOTH\",\"CE\",\"PE\"].map(mode=>/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{setTradeSideModeState(mode);try{await setTradeSideMode(mode);}catch(_unused8){}},style:_objectSpread(_objectSpread({padding:\"6px 14px\",borderRadius:4,border:\"none\",background:tradeSideMode===mode?colors.primary:\"transparent\",color:tradeSideMode===mode?colors.text.primary:colors.text.tertiary},typography.bodySmall),{},{fontWeight:600,cursor:\"pointer\",transition:\"all 0.2s ease\"}),onMouseEnter:e=>{if(tradeSideMode!==mode){e.target.style.background=colors.bg.tertiary;e.target.style.color=colors.text.secondary;}},onMouseLeave:e=>{if(tradeSideMode!==mode){e.target.style.background=\"transparent\";e.target.style.color=colors.text.tertiary;}},children:mode===\"BOTH\"?\"CE + PE\":mode},mode))})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:spacing.xxl},children:[/*#__PURE__*/_jsx(\"h2\",{style:_objectSpread(_objectSpread({},typography.headingLarge),{},{color:colors.text.primary,marginBottom:spacing.md}),children:\"Active Positions\"}),/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(\"div\",{style:{overflowX:\"auto\"},children:/*#__PURE__*/_jsxs(\"table\",{style:_objectSpread(_objectSpread({width:\"100%\",borderCollapse:\"collapse\"},typography.bodyMedium),{},{tableLayout:\"fixed\"}),children:[/*#__PURE__*/_jsxs(\"colgroup\",{children:[/*#__PURE__*/_jsx(\"col\",{style:{width:\"3%\"}}),/*#__PURE__*/_jsx(\"col\",{style:{width:\"5%\"}}),/*#__PURE__*/_jsx(\"col\",{style:{width:\"18%\"}}),/*#__PURE__*/_jsx(\"col\",{style:{width:\"7%\"}}),/*#__PURE__*/_jsx(\"col\",{style:{width:\"11%\"}}),/*#__PURE__*/_jsx(\"col\",{style:{width:\"10%\"}}),/*#__PURE__*/_jsx(\"col\",{style:{width:\"10%\"}}),/*#__PURE__*/_jsx(\"col\",{style:{width:\"7%\"}}),/*#__PURE__*/_jsx(\"col\",{style:{width:\"7%\"}}),/*#__PURE__*/_jsx(\"col\",{style:{width:\"7%\"}}),/*#__PURE__*/_jsx(\"col\",{style:{width:\"10%\"}}),/*#__PURE__*/_jsx(\"col\",{style:{width:\"9%\"}})]}),/*#__PURE__*/_jsx(\"thead\",{style:{background:colors.bg.tertiary},children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:_objectSpread(_objectSpread({},th),{},{textAlign:\"center\"}),children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{style:_objectSpread(_objectSpread({},th),{},{textAlign:\"center\"}),children:\"Side\"}),/*#__PURE__*/_jsx(\"th\",{style:_objectSpread(_objectSpread({},th),{},{textAlign:\"center\"}),children:\"Symbol\"}),/*#__PURE__*/_jsx(\"th\",{style:_objectSpread(_objectSpread({},th),{},{textAlign:\"center\"}),children:\"Strike\"}),/*#__PURE__*/_jsx(\"th\",{style:_objectSpread(_objectSpread({},th),{},{textAlign:\"center\"}),children:\"Time\"}),/*#__PURE__*/_jsx(\"th\",{style:_objectSpread(_objectSpread({},th),{},{textAlign:\"center\"}),children:\"State\"}),/*#__PURE__*/_jsx(\"th\",{style:_objectSpread(_objectSpread({},th),{},{textAlign:\"center\"}),children:\"LTP\"}),/*#__PURE__*/_jsx(\"th\",{style:_objectSpread(_objectSpread({},th),{},{textAlign:\"center\"}),children:\"Entry\"}),/*#__PURE__*/_jsx(\"th\",{style:_objectSpread(_objectSpread({},th),{},{textAlign:\"center\"}),children:\"SL\"}),/*#__PURE__*/_jsx(\"th\",{style:_objectSpread(_objectSpread({},th),{},{textAlign:\"center\"}),children:\"TP\"}),/*#__PURE__*/_jsx(\"th\",{style:_objectSpread(_objectSpread({},th),{},{textAlign:\"center\"}),children:\"P&L Trend\"}),/*#__PURE__*/_jsx(\"th\",{style:_objectSpread(_objectSpread({},th),{},{textAlign:\"center\"}),children:\"P&L\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:rows.length===0?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"12\",style:{padding:0,border:\"none\"},children:/*#__PURE__*/_jsx(EmptyState,{icon:\"\\uD83D\\uDCCA\",title:\"No active positions\",description:\"Positions will appear here once trades are executed based on your strategy settings.\"})})}):rows.map((r,i)=>{const slot=activeTradeBySymbol[r.tradingsymbol]||null;const state=slot?slot.state:\"ARMED\";const liveLtp=ltpMap[normalizeSymbol(r.tradingsymbol)];let pnl=null;if(slot&&ACTIVE_STATES.includes(slot.state)&&typeof slot.buy_price===\"number\"&&typeof liveLtp===\"number\"){pnl=(liveLtp-slot.buy_price)*(slot.qty||0);}return/*#__PURE__*/_jsxs(\"tr\",{style:{background:i%2?colors.bg.secondary:colors.bg.primary,transition:\"background 0.15s ease\",cursor:\"default\",borderTop:\"1px solid \".concat(colors.border.dark)},onMouseEnter:e=>e.currentTarget.style.background=colors.bg.tertiary,onMouseLeave:e=>e.currentTarget.style.background=i%2?colors.bg.secondary:colors.bg.primary,children:[/*#__PURE__*/_jsx(\"td\",{style:_objectSpread(_objectSpread({},td),{},{textAlign:\"center\"}),children:/*#__PURE__*/_jsx(\"span\",{style:{color:colors.text.muted},children:r.idx})}),/*#__PURE__*/_jsx(\"td\",{style:_objectSpread(_objectSpread({},td),{},{textAlign:\"center\"}),children:/*#__PURE__*/_jsx(\"span\",{style:{padding:\"2px 8px\",borderRadius:4,background:r.side===\"CE\"?colors.successBg:colors.dangerBg,color:r.side===\"CE\"?colors.success:colors.danger,fontSize:11,fontWeight:600},children:r.side})}),/*#__PURE__*/_jsx(\"td\",{style:_objectSpread(_objectSpread(_objectSpread({},td),typography.mono),{},{fontWeight:600,color:colors.text.primary,whiteSpace:\"nowrap\",overflow:\"hidden\",textOverflow:\"ellipsis\",textAlign:\"center\"}),title:r.tradingsymbol,children:r.tradingsymbol}),/*#__PURE__*/_jsx(\"td\",{style:_objectSpread(_objectSpread(_objectSpread({},td),typography.mono),{},{color:colors.text.secondary,textAlign:\"center\"}),children:r.strike}),/*#__PURE__*/_jsx(\"td\",{style:_objectSpread(_objectSpread(_objectSpread({},td),typography.mono),{},{fontSize:11,color:colors.text.tertiary,textAlign:\"center\"}),children:formatTimestamp(r.selected_at)}),/*#__PURE__*/_jsx(\"td\",{style:_objectSpread(_objectSpread({},td),{},{textAlign:\"center\"}),children:/*#__PURE__*/_jsx(StatusBadge,{ok:ACTIVE_STATES.includes(state),warn:!ACTIVE_STATES.includes(state),text:state})}),/*#__PURE__*/_jsx(\"td\",{style:_objectSpread(_objectSpread(_objectSpread({},td),typography.mono),{},{color:colors.text.primary,textAlign:\"center\"}),children:typeof liveLtp===\"number\"?liveLtp.toFixed(2):\"â€”\"}),/*#__PURE__*/_jsx(\"td\",{style:_objectSpread(_objectSpread(_objectSpread({},td),typography.mono),{},{color:colors.text.secondary,textAlign:\"center\"}),children:typeof(slot===null||slot===void 0?void 0:slot.buy_price)===\"number\"?slot.buy_price.toFixed(2):\"â€”\"}),/*#__PURE__*/_jsx(\"td\",{style:_objectSpread(_objectSpread(_objectSpread({},td),typography.mono),{},{color:colors.text.tertiary,textAlign:\"center\"}),children:typeof(slot===null||slot===void 0?void 0:slot.sl_price)===\"number\"?slot.sl_price.toFixed(2):\"â€”\"}),/*#__PURE__*/_jsx(\"td\",{style:_objectSpread(_objectSpread(_objectSpread({},td),typography.mono),{},{color:colors.text.tertiary,textAlign:\"center\"}),children:typeof(slot===null||slot===void 0?void 0:slot.tp_price)===\"number\"?slot.tp_price.toFixed(2):\"â€”\"}),/*#__PURE__*/_jsx(\"td\",{style:_objectSpread(_objectSpread(_objectSpread(_objectSpread({},td),typography.mono),{},{textAlign:\"center\"},pnlStyle(pnl)),{},{fontSize:14,background:pnl!==null?pnl>0?colors.profitBg:pnl<0?colors.lossBg:\"transparent\":\"transparent\"}),children:pnl===null?\"â€”\":\"\\u20B9\".concat(Math.round(pnl).toLocaleString('en-IN'))})]},i);})})]})})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{style:_objectSpread(_objectSpread({},typography.headingLarge),{},{color:colors.text.primary,marginBottom:spacing.md}),children:\"Today's Performance\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"grid\",gridTemplateColumns:\"repeat(auto-fit, minmax(300px, 1fr))\",gap:spacing.md},children:[/*#__PURE__*/_jsxs(Card,{elevated:true,style:{padding:spacing.lg},children:[/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},typography.label),{},{color:colors.text.muted,marginBottom:spacing.md}),children:\"Summary\"}),positionsLoading?/*#__PURE__*/_jsx(CardSkeleton,{rows:3}):/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\",gap:spacing.sm},children:[/*#__PURE__*/_jsx(PnLRow,{label:\"Realised\",value:positions.totals.realised}),/*#__PURE__*/_jsx(PnLRow,{label:\"Unrealised\",value:positions.totals.unrealised}),/*#__PURE__*/_jsx(\"div\",{style:{borderTop:\"1px solid \".concat(colors.border.dark),marginTop:spacing.sm,paddingTop:spacing.sm},children:/*#__PURE__*/_jsx(PnLRow,{label:\"Total P&L\",value:positions.totals.total,large:true})})]})]}),/*#__PURE__*/_jsxs(Card,{elevated:true,style:{padding:spacing.lg},children:[/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},typography.label),{},{color:colors.text.muted,marginBottom:spacing.md}),children:\"Open Positions\"}),positionsLoading?/*#__PURE__*/_jsx(CardSkeleton,{rows:3}):/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:200,overflow:\"auto\"},children:positions.open.length===0?/*#__PURE__*/_jsx(EmptyState,{icon:\"\\uD83D\\uDCED\",title:\"No open positions\",description:\"\"}):positions.open.map((p,i)=>/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread(_objectSpread({},typography.bodySmall),typography.mono),{},{marginBottom:spacing.xs,padding:spacing.xs,background:colors.bg.secondary,borderRadius:4,display:\"flex\",justifyContent:\"space-between\"}),children:[/*#__PURE__*/_jsxs(\"span\",{style:{color:colors.text.secondary},children:[p.tradingsymbol,\" \\xD7 \",p.quantity]}),/*#__PURE__*/_jsxs(\"span\",{style:pnlStyle(safeNum(p.pnl)),children:[\"\\u20B9\",Math.round(safeNum(p.pnl)).toLocaleString('en-IN')]})]},i))})]}),/*#__PURE__*/_jsxs(Card,{elevated:true,style:{padding:spacing.lg},children:[/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},typography.label),{},{color:colors.text.muted,marginBottom:spacing.md}),children:\"Closed Positions\"}),positionsLoading?/*#__PURE__*/_jsx(CardSkeleton,{rows:3}):/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:200,overflow:\"auto\"},children:positions.closed.length===0?/*#__PURE__*/_jsx(EmptyState,{icon:\"\\uD83D\\uDCED\",title:\"No closed positions\",description:\"\"}):positions.closed.map((p,i)=>/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread(_objectSpread({},typography.bodySmall),typography.mono),{},{marginBottom:spacing.xs,padding:spacing.xs,background:colors.bg.secondary,borderRadius:4,display:\"flex\",justifyContent:\"space-between\"}),children:[/*#__PURE__*/_jsxs(\"span\",{style:{color:colors.text.secondary},children:[p.tradingsymbol,\" \\xD7 \",p.day_buy_quantity]}),/*#__PURE__*/_jsxs(\"span\",{style:pnlStyle(safeNum(p.pnl)),children:[\"\\u20B9\",Math.round(safeNum(p.pnl)).toLocaleString('en-IN')]})]},i))})]})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:spacing.xxl},children:/*#__PURE__*/_jsx(DebugPanel,{rows:rows})})]});}/* ----------------------------------\n   Helper Components\n----------------------------------- */function PnLRow(_ref9){let{label,value,large}=_ref9;return/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\"},children:[/*#__PURE__*/_jsx(\"span\",{style:_objectSpread(_objectSpread({},large?typography.bodyLarge:typography.bodyMedium),{},{color:colors.text.secondary,fontWeight:large?600:400}),children:label}),/*#__PURE__*/_jsxs(\"span\",{style:_objectSpread(_objectSpread(_objectSpread({},large?typography.headingMedium:typography.bodyMedium),typography.mono),pnlStyle(value)),children:[\"\\u20B9\",Math.round(value).toLocaleString('en-IN')]})]});}function MarketBadge(_ref0){let{name,data}=_ref0;const[pulse,setPulse]=useState(false);const prevLtpRef=useRef(null);const ltp=typeof(data===null||data===void 0?void 0:data.ltp)===\"number\"?data.ltp:null;const prevClose=typeof(data===null||data===void 0?void 0:data.prev_close)===\"number\"?data.prev_close:ltp;// âœ… Hooks ALWAYS run\nuseEffect(()=>{if(ltp===null)return;if(prevLtpRef.current!==null&&prevLtpRef.current!==ltp){setPulse(true);const t=setTimeout(()=>setPulse(false),180);return()=>clearTimeout(t);}prevLtpRef.current=ltp;},[ltp]);// âœ… Conditional render AFTER hooks\nif(ltp===null||prevClose===null){return null;}const change=ltp-prevClose;const pct=prevClose!==0?change/prevClose*100:0;const up=change>=0;const bg=up?colors.successBg:colors.dangerBg;const color=up?colors.success:colors.danger;return/*#__PURE__*/_jsxs(\"span\",{style:{display:\"inline-flex\",alignItems:\"center\",gap:8,padding:\"6px 12px\",minHeight:28,borderRadius:6,background:bg,color,border:\"1px solid \".concat(color,\"40\"),fontSize:11,fontWeight:600,letterSpacing:\"0.3px\",textTransform:\"uppercase\",filter:pulse?\"brightness(1.25)\":\"brightness(1)\",boxShadow:pulse?\"0 0 8px \".concat(color,\"55\"):\"none\",transition:\"filter 0.18s ease, box-shadow 0.18s ease\"},children:[/*#__PURE__*/_jsx(\"span\",{style:{opacity:0.9},children:name}),/*#__PURE__*/_jsx(\"span\",{style:_objectSpread(_objectSpread({},typography.mono),{},{fontSize:12}),children:ltp.toFixed(2)}),/*#__PURE__*/_jsxs(\"span\",{style:_objectSpread(_objectSpread({},typography.mono),{},{fontSize:11}),children:[up?\"â–²\":\"â–¼\",\" \",pct.toFixed(2),\"%\"]})]});}/* ----------------------------------\n   Styles\n----------------------------------- */const th=_objectSpread(_objectSpread({padding:\"12px 12px\",textAlign:\"left\"},typography.label),{},{color:colors.text.muted,borderBottom:\"2px solid \".concat(colors.border.light),fontWeight:600});const td=_objectSpread({padding:\"12px 12px\"},typography.bodyMedium);const styles=\"\\n  @keyframes loading {\\n    0% { transform: translateX(-100%); }\\n    100% { transform: translateX(400%); }\\n  }\\n\";if(typeof document!=='undefined'&&!document.getElementById('dashboard-styles')){const styleSheet=document.createElement('style');styleSheet.id='dashboard-styles';styleSheet.textContent=styles;document.head.appendChild(styleSheet);}","map":{"version":3,"names":["useEffect","useState","useMemo","useRef","getTradeState","getZerodhaStatus","getActiveTrade","getLogs","getCurrentSelection","getStatus","getTodayTrades","getTodayPositions","getStrategyConfig","getTradeSideMode","setTradeSideMode","DebugPanel","LoadingAnimations","FullPageLoader","EmptyState","TableSkeleton","CardSkeleton","useToast","Sparkline","PriceChangeIndicator","ProgressBar","PriceWithSparkline","PnLTrendArrow","exportToCSV","formatTradesForExport","generateFilename","getApiBase","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","spacing","xs","sm","md","lg","xl","xxl","typography","displayLarge","fontSize","fontWeight","lineHeight","displaySmall","headingLarge","headingMedium","headingSmall","bodyLarge","bodyMedium","bodySmall","label","letterSpacing","textTransform","mono","fontFamily","fontVariantNumeric","colors","profit","profitBg","loss","lossBg","neutral","primary","primaryBg","success","successBg","warning","warningBg","danger","dangerBg","bg","secondary","tertiary","elevated","border","light","medium","dark","text","muted","ACTIVE_STATES","AudioAlerts","context","init","window","AudioContext","webkitAudioContext","playTone","frequency","duration","type","arguments","length","undefined","oscillator","createOscillator","gainNode","createGain","connect","destination","value","gain","setValueAtTime","currentTime","exponentialRampToValueAtTime","start","stop","positionEntered","setTimeout","stopLossHit","takeProfitHit","normalizeSymbol","sym","replace","toUpperCase","StatusBadge","_ref","ok","warn","icon","color","borderColor","style","_objectSpread","padding","borderRadius","background","concat","display","alignItems","gap","minWidth","justifyContent","children","safeNum","v","isNaN","pnlStyle","formatTimestamp","timestamp","date","Date","today","isToday","getDate","getMonth","getFullYear","toLocaleTimeString","hour","minute","second","hour12","toLocaleString","year","month","day","Card","_ref2","boxShadow","Dashboard","toast","zerodha","setZerodha","status","setStatus","trade","setTrade","logs","setLogs","selection","setSelection","tradeState","setTradeState","tradeSideMode","setTradeSideModeState","strategyConfig","setStrategyConfig","indices","setIndices","loading","setLoading","backendHealth","setBackendHealth","booting","setBooting","positions","setPositions","open","closed","totals","realised","unrealised","total","ltpMap","setLtpMap","prevTradeState","setPrevTradeState","positionsLoading","setPositionsLoading","priceHistory","setPriceHistory","pnlHistory","setPnlHistory","console","log","__SCALP_API_BASE__","__TAURI__","Object","keys","prev","updated","entries","forEach","_ref3","symbol","price","slice","hasChanges","_ref4","slot","state","includes","liveLtp","buyPrice","buy_price","qty","pnl","lastPnl","_ref5","currentState","prevState","curr","realized_pnl","priceStr","toFixed","info","pnlStr","Math","round","error","initialLoad","loadFast","loadSlow","fast","setInterval","slow","clearInterval","alive","pollLtp","res","fetch","data","json","normalized","_ref6","_unused","Promise","r","pollIndices","_unused2","apiBase","e","statusUrl","s","JSON","stringify","backend","message","stack","_unused3","_unused4","l","Array","isArray","_unused5","p","reduce","x","_unused6","mode","_unused7","symbolToSlot","_ref7","activeTradeBySymbol","map","_ref8","t","rows","CE","o","i","push","side","idx","tradingsymbol","PE","tradingEnabled","trade_on","executionMode","trade_execution_mode","inTrade","values","some","handleExportTrades","allPositions","formattedTrades","minHeight","position","top","left","right","height","zIndex","animation","width","marginBottom","margin","flexWrap","connected","engine","MarketBadge","name","NIFTY","BANKNIFTY","flex","onClick","_unused8","cursor","transition","onMouseEnter","target","onMouseLeave","overflowX","borderCollapse","tableLayout","th","textAlign","colSpan","title","description","borderTop","currentTarget","td","whiteSpace","overflow","textOverflow","strike","selected_at","sl_price","tp_price","gridTemplateColumns","flexDirection","PnLRow","marginTop","paddingTop","large","maxHeight","quantity","day_buy_quantity","_ref9","_ref0","pulse","setPulse","prevLtpRef","ltp","prevClose","prev_close","current","clearTimeout","change","pct","up","filter","opacity","borderBottom","styles","document","getElementById","styleSheet","createElement","id","textContent","head","appendChild"],"sources":["/Users/anbu/dev/scalp-app/desktop/src-tauri/frontend/src/pages/Dashboard.jsx"],"sourcesContent":["import { useEffect, useState, useMemo, useRef } from \"react\";\nimport {\n  getTradeState,\n  getZerodhaStatus,\n  getActiveTrade,\n  getLogs,\n  getCurrentSelection,\n  getStatus,\n  getTodayTrades,\n  getTodayPositions,\n  getStrategyConfig\n} from \"../api\";\nimport { getTradeSideMode, setTradeSideMode } from \"../api\";\nimport DebugPanel from \"../components/DebugPanel\";\nimport { \n  LoadingAnimations, \n  FullPageLoader, \n  EmptyState, \n  TableSkeleton,\n  CardSkeleton \n} from \"../components/LoadingStates\";\nimport { useToast } from \"../components/ToastNotifications\";\nimport {\n  Sparkline,\n  PriceChangeIndicator,\n  ProgressBar,\n  PriceWithSparkline,\n  PnLTrendArrow\n} from \"../components/DataVisualization\";\nimport {\n  exportToCSV,\n  formatTradesForExport,\n  generateFilename\n} from \"../utils/export\";\nimport { getApiBase } from \"../api/base\";\n\n// BOOTING | UP | DOWN\n\n/* ----------------------------------\n   Typography & Spacing Tokens\n----------------------------------- */\nconst spacing = {\n  xs: 4,\n  sm: 8,\n  md: 12,\n  lg: 16,\n  xl: 20,\n  xxl: 24\n};\n\nconst typography = {\n  displayLarge: { fontSize: 28, fontWeight: 700, lineHeight: 1.2 },\n  displaySmall: { fontSize: 24, fontWeight: 600, lineHeight: 1.3 },\n  headingLarge: { fontSize: 18, fontWeight: 600, lineHeight: 1.4 },\n  headingMedium: { fontSize: 16, fontWeight: 600, lineHeight: 1.4 },\n  headingSmall: { fontSize: 14, fontWeight: 600, lineHeight: 1.4 },\n  bodyLarge: { fontSize: 14, fontWeight: 400, lineHeight: 1.5 },\n  bodyMedium: { fontSize: 13, fontWeight: 400, lineHeight: 1.5 },\n  bodySmall: { fontSize: 12, fontWeight: 400, lineHeight: 1.4 },\n  label: { fontSize: 11, fontWeight: 500, lineHeight: 1.3, letterSpacing: '0.5px', textTransform: 'uppercase' },\n  mono: { fontFamily: \"'JetBrains Mono', 'Fira Code', monospace\", fontVariantNumeric: \"tabular-nums\" }\n};\n\nconst colors = {\n  profit: \"#10b981\",\n  profitBg: \"rgba(16, 185, 129, 0.12)\",\n  loss: \"#ef4444\",\n  lossBg: \"rgba(239, 68, 68, 0.12)\",\n  neutral: \"#6b7280\",\n  primary: \"#3b82f6\",\n  primaryBg: \"rgba(59, 130, 246, 0.12)\",\n  success: \"#10b981\",\n  successBg: \"rgba(16, 185, 129, 0.15)\",\n  warning: \"#f59e0b\",\n  warningBg: \"rgba(245, 158, 11, 0.15)\",\n  danger: \"#ef4444\",\n  dangerBg: \"rgba(239, 68, 68, 0.15)\",\n  bg: {\n    primary: \"#0a0f1e\",\n    secondary: \"#111827\",\n    tertiary: \"#1f2937\",\n    elevated: \"#374151\"\n  },\n  border: {\n    light: \"#374151\",\n    medium: \"#4b5563\",\n    dark: \"#1f2937\"\n  },\n  text: {\n    primary: \"#f9fafb\",\n    secondary: \"#d1d5db\",\n    tertiary: \"#9ca3af\",\n    muted: \"#6b7280\"\n  }\n};\n\nconst ACTIVE_STATES = [\"BUY_PLACED\", \"PROTECTED\", \"BUY_FILLED\", \"IN_TRADE\"];\n\n\n/* ----------------------------------\n   Audio Alert System\n----------------------------------- */\n\nconst AudioAlerts = {\n  context: null,\n  \n  init() {\n    if (!this.context && typeof window !== 'undefined') {\n      this.context = new (window.AudioContext || window.webkitAudioContext)();\n    }\n  },\n  \n  playTone(frequency, duration, type = 'sine') {\n    this.init();\n    if (!this.context) return;\n    \n    const oscillator = this.context.createOscillator();\n    const gainNode = this.context.createGain();\n    \n    oscillator.connect(gainNode);\n    gainNode.connect(this.context.destination);\n    \n    oscillator.frequency.value = frequency;\n    oscillator.type = type;\n    \n    gainNode.gain.setValueAtTime(0.3, this.context.currentTime);\n    gainNode.gain.exponentialRampToValueAtTime(0.01, this.context.currentTime + duration);\n    \n    oscillator.start(this.context.currentTime);\n    oscillator.stop(this.context.currentTime + duration);\n  },\n  \n  // New position entered\n  positionEntered() {\n    this.playTone(800, 0.15);\n    setTimeout(() => this.playTone(1000, 0.15), 150);\n  },\n  \n  // Stop loss hit\n  stopLossHit() {\n    this.playTone(400, 0.2);\n    setTimeout(() => this.playTone(350, 0.2), 200);\n    setTimeout(() => this.playTone(300, 0.3), 400);\n  },\n  \n  // Take profit hit\n  takeProfitHit() {\n    this.playTone(600, 0.1);\n    setTimeout(() => this.playTone(800, 0.1), 100);\n    setTimeout(() => this.playTone(1000, 0.15), 200);\n  }\n};\n\n/* ----------------------------------\n   Small helpers\n----------------------------------- */\nfunction normalizeSymbol(sym) {\n  if (!sym) return sym;\n  return sym.replace(/\\s+/g, \"\").toUpperCase();\n}\n\nfunction StatusBadge({ ok, text, warn, danger, icon }) {\n  let bg = colors.dangerBg;\n  let color = colors.danger;\n  let borderColor = colors.danger;\n\n  if (ok) {\n    bg = colors.successBg;\n    color = colors.success;\n    borderColor = colors.success;\n  } else if (danger) {\n    bg = colors.dangerBg;\n    color = colors.danger;\n    borderColor = colors.danger;\n  } else if (warn) {\n    bg = colors.warningBg;\n    color = colors.warning;\n    borderColor = colors.warning;\n  }\n\n  return (\n    <span\n      style={{\n        padding: \"4px 10px\",\n        borderRadius: 6,\n        ...typography.bodySmall,\n        fontWeight: 600,\n        background: bg,\n        color,\n        border: `1px solid ${borderColor}40`,\n        display: \"inline-flex\",\n        alignItems: \"center\",\n        gap: 4,\n        minWidth: \"90px\",\n        justifyContent: \"center\",\n        textTransform: \"uppercase\",\n        letterSpacing: \"0.3px\"\n      }}\n    >\n      {icon && <span style={{ fontSize: 10 }}>{icon}</span>}\n      {text}\n    </span>\n  );\n}\n\nconst safeNum = (v) => (typeof v === \"number\" && !isNaN(v) ? v : 0);\nconst pnlStyle = (v) => ({\n  color: v > 0 ? colors.profit : v < 0 ? colors.loss : colors.neutral,\n  fontWeight: 600\n});\n\nconst formatTimestamp = (timestamp) => {\n  if (!timestamp) return \"â€”\";\n  \n  const date = new Date(timestamp);\n  const today = new Date();\n  \n  const isToday = \n    date.getDate() === today.getDate() &&\n    date.getMonth() === today.getMonth() &&\n    date.getFullYear() === today.getFullYear();\n  \n  if (isToday) {\n    return date.toLocaleTimeString('en-IN', { \n      hour: '2-digit', \n      minute: '2-digit', \n      second: '2-digit',\n      hour12: false \n    });\n  } else {\n    return date.toLocaleString('en-IN', { \n      year: 'numeric',\n      month: '2-digit',\n      day: '2-digit',\n      hour: '2-digit', \n      minute: '2-digit',\n      hour12: false \n    });\n  }\n};\n\n/* ----------------------------------\n   Card Component\n----------------------------------- */\nfunction Card({ children, style, elevated }) {\n  return (\n    <div\n      style={{\n        background: elevated ? colors.bg.tertiary : colors.bg.secondary,\n        border: `1px solid ${colors.border.light}`,\n        borderRadius: 8,\n        boxShadow: elevated ? \"0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2)\" : \"0 1px 3px rgba(0, 0, 0, 0.2)\",\n        ...style\n      }}\n    >\n      {children}\n    </div>\n  );\n}\n\n/* ----------------------------------\n   Dashboard\n----------------------------------- */\n\nexport default function Dashboard() {\n  const toast = useToast();\n  const [zerodha, setZerodha] = useState(null);\n  const [status, setStatus] = useState(null);\n  const [trade, setTrade] = useState(null);\n  const [logs, setLogs] = useState([]);\n  const [selection, setSelection] = useState(null);\n  const [tradeState, setTradeState] = useState(null);\n  const [tradeSideMode, setTradeSideModeState] = useState(\"BOTH\");\n  const [strategyConfig, setStrategyConfig] = useState(null);\n  const [indices, setIndices] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [backendHealth, setBackendHealth] = useState(\"BOOTING\");\n  const [booting, setBooting] = useState(true);\n\n  const [positions, setPositions] = useState({\n    open: [],\n    closed: [],\n    totals: { realised: 0, unrealised: 0, total: 0 }\n  });\n\n  const [ltpMap, setLtpMap] = useState({});\n  const [prevTradeState, setPrevTradeState] = useState(null);\n  const [positionsLoading, setPositionsLoading] = useState(true);\n  \n  // Track price history for sparklines\n  const [priceHistory, setPriceHistory] = useState({});\n  const [pnlHistory, setPnlHistory] = useState({});\n\n  // Add this inside Dashboard component, after the useEffect\n  useEffect(() => {\n    console.log('[DEBUG] Window.__SCALP_API_BASE__:', window.__SCALP_API_BASE__);\n    console.log('[DEBUG] Window.__TAURI__:', window.__TAURI__);\n    console.log('[DEBUG] Resolved API base:', getApiBase());\n  }, []);\n\n  // Update price history when LTP changes\n  useEffect(() => {\n    if (ltpMap && Object.keys(ltpMap).length > 0) {\n      setPriceHistory(prev => {\n        const updated = { ...prev };\n        Object.entries(ltpMap).forEach(([symbol, price]) => {\n          if (typeof price === 'number') {\n            if (!updated[symbol]) {\n              updated[symbol] = [];\n            }\n            // Keep last 30 data points for sparkline\n            updated[symbol] = [...updated[symbol], price].slice(-30);\n          }\n        });\n        return updated;\n      });\n    }\n  }, [ltpMap]);\n\n  // Update PnL history when trade state or LTP changes\n  useEffect(() => {\n    if (!tradeState || !ltpMap || Object.keys(ltpMap).length === 0) return;\n\n    setPnlHistory(prev => {\n      const updated = { ...prev };\n      let hasChanges = false;\n\n      Object.entries(tradeState).forEach(([slot, state]) => {\n        if (!state || typeof state !== 'object') return;\n        \n        const symbol = state.symbol;\n        if (!symbol || !ACTIVE_STATES.includes(state.state)) return;\n\n        const liveLtp = ltpMap[symbol];\n        const buyPrice = state.buy_price;\n        const qty = state.qty;\n\n        if (typeof buyPrice === 'number' && typeof liveLtp === 'number' && typeof qty === 'number') {\n          const pnl = (liveLtp - buyPrice) * qty;\n          \n          if (!updated[symbol]) {\n            updated[symbol] = [];\n          }\n          \n          // Only add if different from last value\n          const lastPnl = updated[symbol][updated[symbol].length - 1];\n          if (lastPnl !== pnl) {\n            updated[symbol] = [...updated[symbol], pnl].slice(-10);\n            hasChanges = true;\n          }\n        }\n      });\n\n      return hasChanges ? updated : prev;\n    });\n  }, [tradeState, ltpMap]);\n\n  // Track previous states for audio alerts and toast notifications\n  useEffect(() => {\n    if (!tradeState || !prevTradeState) {\n      setPrevTradeState(tradeState);\n      return;\n    }\n\n    // Check for state changes\n    Object.entries(tradeState).forEach(([slot, currentState]) => {\n      const prevState = prevTradeState[slot];\n      \n      if (!prevState || !currentState) return;\n      \n      const curr = typeof currentState === 'object' ? currentState.state : currentState;\n      const prev = typeof prevState === 'object' ? prevState.state : prevState;\n      \n      // Skip if no actual state change\n      if (curr === prev) return;\n      \n      // Get symbol for notification\n      const symbol = typeof currentState === 'object' ? currentState.symbol : slot;\n      const price = typeof currentState === 'object' ? currentState.buy_price : null;\n      const pnl = typeof currentState === 'object' ? currentState.realized_pnl || currentState.pnl : null;\n      \n      console.log(`State change detected: ${slot} ${prev} -> ${curr} (${symbol})`);\n      \n      // New position entered (ARMED -> BUY_PLACED, BUY_FILLED, PROTECTED, or IN_TRADE)\n      if (prev === 'ARMED' && (curr === 'BUY_PLACED' || curr === 'BUY_FILLED' || curr === 'PROTECTED' || curr === 'IN_TRADE')) {\n        console.log('ðŸ”Š Position entered alert');\n        AudioAlerts.positionEntered();\n        const priceStr = price ? ` @ â‚¹${price.toFixed(2)}` : '';\n        toast.info(\n          \"Position Entered\",\n          `${symbol}${priceStr}`,\n          { duration: 4000 }\n        );\n      }\n      \n      // Position exited - check multiple exit states\n      if (ACTIVE_STATES.includes(prev) && (curr === 'SL_HIT' || curr === 'TP_HIT' || curr === 'EXITED' || curr === 'CLOSED')) {\n        console.log(`ðŸ”Š Position exit alert: ${curr}`);\n        \n        const pnlStr = pnl ? ` ${pnl > 0 ? '+' : ''}â‚¹${Math.round(pnl).toLocaleString('en-IN')}` : '';\n        \n        if (curr === 'SL_HIT') {\n          AudioAlerts.stopLossHit();\n          toast.error(\n            \"Stop Loss Hit\",\n            `${symbol}${pnlStr}`,\n            { duration: 6000 }\n          );\n        } else if (curr === 'TP_HIT') {\n          AudioAlerts.takeProfitHit();\n          toast.success(\n            \"Target Reached\",\n            `${symbol}${pnlStr} ðŸŽ‰`,\n            { duration: 6000, icon: \"ðŸŽ¯\" }\n          );\n        } else {\n          // Generic exit (EXITED/CLOSED)\n          if (pnl && pnl > 0) {\n            AudioAlerts.takeProfitHit();\n            toast.success(\n              \"Position Closed\",\n              `${symbol}${pnlStr}`,\n              { duration: 5000 }\n            );\n          } else {\n            AudioAlerts.stopLossHit();\n            toast.warning(\n              \"Position Closed\",\n              `${symbol}${pnlStr}`,\n              { duration: 5000 }\n            );\n          }\n        }\n      }\n    });\n\n    setPrevTradeState(tradeState);\n  }, [tradeState, toast]);\n\n\n  useEffect(() => {\n    async function initialLoad() {\n      await loadFast();\n      await loadSlow();\n      setLoading(false);\n    }\n    \n    initialLoad();\n\n    const fast = setInterval(loadFast, 3000);\n    const slow = setInterval(loadSlow, 15000);\n\n    return () => {\n      clearInterval(fast);\n      clearInterval(slow);\n    };\n  }, []);\n\n  useEffect(() => {\n    let alive = true;\n  \n    async function pollLtp() {\n      while (alive) {\n        try {\n          const res = await fetch(`${getApiBase()}/ltp_snapshot`);\n          if (res.ok) {\n            const data = await res.json();\n            if (data && typeof data === \"object\") {\n              // Normalize all keys before storing\n              const normalized = {};\n              Object.entries(data).forEach(([symbol, price]) => {\n                normalized[normalizeSymbol(symbol)] = price;\n              });\n              setLtpMap(normalized);\n            }\n          }\n        } catch {}\n  \n        await new Promise(r => setTimeout(r, 500));\n      }\n    }\n  \n    pollLtp();\n    return () => { alive = false; };\n  }, []);\n  \n\n  useEffect(() => {\n    let alive = true;\n  \n    async function pollIndices() {\n      while (alive) {\n        try {\n          const res = await fetch(`${getApiBase()}/market_indices`);\n          if (res.ok) {\n            const data = await res.json();\n            if (data && typeof data === \"object\") {\n              setIndices(data);\n            }\n          }\n        } catch {}\n  \n        await new Promise(r => setTimeout(r, 500));\n      }\n    }\n  \n    pollIndices();\n    return () => { alive = false; };\n  }, []);\n  \n  async function loadFast() {\n    // ---- DEBUG: Check API base ----\n    console.log('[DEBUG] === loadFast called ===');\n    console.log('[DEBUG] window.__SCALP_API_BASE__:', window.__SCALP_API_BASE__);\n    console.log('[DEBUG] window.__TAURI__:', !!window.__TAURI__);\n    \n    try {\n      const apiBase = getApiBase();\n      console.log('[DEBUG] getApiBase() returned:', apiBase);\n    } catch (e) {\n      console.error('[DEBUG] getApiBase() error:', e);\n    }\n\n    // ---- BACKEND / ENGINE STATUS ----\n    try {\n      const statusUrl = `${getApiBase()}/status`;\n      console.log('[DEBUG] Fetching status from:', statusUrl);\n      \n      const s = await getStatus();\n      console.log('[DEBUG] Status response:', JSON.stringify(s, null, 2));\n      \n      setStatus(s);\n\n      if (s?.backend === \"UP\") {\n        console.log('[DEBUG] âœ… Backend is UP, setting health to UP');\n        setBackendHealth(\"UP\");\n        setBooting(false);\n      } else {\n        console.log('[DEBUG] âŒ Backend not UP, status.backend =', s?.backend);\n        setBackendHealth(\"DOWN\");\n      }\n    } catch (error) {\n      console.error('[DEBUG] âŒ Error fetching status:', error);\n      console.error('[DEBUG] Error message:', error.message);\n      console.error('[DEBUG] Error stack:', error.stack);\n      setBackendHealth(prev => {\n        console.log('[DEBUG] Setting backend health, prev was:', prev);\n        return prev === \"UP\" ? \"DOWN\" : prev;\n      });\n    }\n\n    // ---- REST ----\n    try { \n      const trade = await getActiveTrade();\n      console.log('[DEBUG] Active trade:', trade);\n      setTrade(trade);\n    } catch (e) {\n      console.error('[DEBUG] getActiveTrade error:', e);\n    }\n    \n    try { \n      const tradeState = await getTradeState();\n      console.log('[DEBUG] Trade state:', tradeState);\n      setTradeState(tradeState);\n    } catch (e) {\n      console.error('[DEBUG] getTradeState error:', e);\n    }\n    \n    try { \n      const selection = await getCurrentSelection();\n      console.log('[DEBUG] Current selection:', selection);\n      setSelection(selection);\n    } catch (e) {\n      console.error('[DEBUG] getCurrentSelection error:', e);\n    }\n  }\n  \n\n  async function loadSlow() {\n    try { setZerodha(await getZerodhaStatus()); } catch {}\n    try { setStrategyConfig(await getStrategyConfig()); } catch {}\n\n    try {\n      const l = await getLogs();\n      setLogs(Array.isArray(l) ? l : l?.logs || []);\n    } catch {}\n\n    try {\n      setPositionsLoading(true);\n      const p = await getTodayPositions();\n      const open = p?.open || [];\n      const closed = p?.closed || [];\n\n      const realised = closed.reduce((s, x) => s + safeNum(x.pnl), 0);\n      const unrealised = open.reduce((s, x) => s + safeNum(x.pnl), 0);\n\n      setPositions({\n        open,\n        closed,\n        totals: {\n          realised,\n          unrealised,\n          total: realised + unrealised,\n        },\n      });\n    } catch {\n      setPositions({\n        open: [],\n        closed: [],\n        totals: { realised: 0, unrealised: 0, total: 0 }\n      });\n    } finally {\n      setPositionsLoading(false);\n    }\n\n    try {\n      const res = await getTradeSideMode();\n      setTradeSideModeState(res?.mode || \"BOTH\");\n    } catch {}\n  }\n\n  const symbolToSlot = {};\n  if (tradeState) {\n    Object.entries(tradeState).forEach(([slot, data]) => {\n      if (data && typeof data === \"object\" && data.symbol) {\n        symbolToSlot[data.symbol] = slot;\n      }\n    });\n  }\n\n  const activeTradeBySymbol = useMemo(() => {\n    if (!tradeState) return {};\n    const map = {};\n    Object.entries(tradeState).forEach(([slot, t]) => {\n      if (t && typeof t === \"object\" && t.symbol) {\n        map[t.symbol] = { ...t, slot };\n      }\n    });\n    return map;\n  }, [tradeState]);\n  \n  const rows = [];\n\n  if (selection) {\n    if (tradeSideMode !== \"PE\") {\n      (selection.CE || []).forEach((o, i) =>\n        rows.push({\n          ...o,\n          side: \"CE\",\n          idx: i + 1,\n          slot: symbolToSlot[o.tradingsymbol] || `CE_${i + 1}`,\n        })\n      );\n    }\n\n    if (tradeSideMode !== \"CE\") {\n      (selection.PE || []).forEach((o, i) =>\n        rows.push({\n          ...o,\n          side: \"PE\",\n          idx: i + 1,\n          slot: symbolToSlot[o.tradingsymbol] || `PE_${i + 1}`,\n        })\n      );\n    }\n  }\n\n  const tradingEnabled = strategyConfig?.trade_on === true;\n  const executionMode = strategyConfig?.trade_execution_mode || \"LIVE\";\n\n  const inTrade =\n    tradeState &&\n    Object.values(tradeState).some(\n      v => typeof v === \"object\"\n        ? ACTIVE_STATES.includes(v.state)\n        : v === \"IN_TRADE\"\n    );\n\n    // Export handler\n  function handleExportTrades() {\n    const allPositions = [...positions.open, ...positions.closed];\n    if (allPositions.length === 0) {\n      toast.warning('No Data', 'No trades to export');\n      return;\n    }\n    const formattedTrades = formatTradesForExport(allPositions);\n    exportToCSV(formattedTrades, generateFilename('today_trades', 'csv'));\n    toast.success('Export Complete', `${allPositions.length} trades exported`);\n  }\n\n  if (loading) {\n    return (\n      <>\n        <LoadingAnimations />\n        <FullPageLoader message=\"Loading dashboard...\" />\n      </>\n    );\n  }\n\n  return (\n    <div style={{\n      padding: spacing.xxl,\n      background: colors.bg.primary,\n      color: colors.text.primary,\n      minHeight: \"100vh\",\n      fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif\"\n    }}>\n\n      {loading && (\n        <div style={{\n          position: \"fixed\",\n          top: 0,\n          left: 0,\n          right: 0,\n          height: 2,\n          background: colors.border.dark,\n          zIndex: 1000\n        }}>\n          <div style={{\n            height: \"100%\",\n            background: `linear-gradient(90deg, ${colors.primary}, ${colors.success})`,\n            animation: \"loading 1.5s ease-in-out infinite\",\n            width: \"40%\"\n          }} />\n        </div>\n      )}\n\n      {/* ---------- HEADER ---------- */}\n      <div style={{ marginBottom: spacing.xxl }}>\n        <div style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"space-between\", marginBottom: spacing.lg }}>\n          <h1 style={{ margin: 0, ...typography.displayLarge, color: colors.text.primary }}>\n            Scalp Terminal\n          </h1>\n          <div style={{ ...typography.label, color: colors.text.muted }}>\n            Live Trading Dashboard\n          </div>\n        </div>\n\n        {/* Status Bar with Trade Mode */}\n        <Card elevated style={{ padding: spacing.md, marginBottom: spacing.lg }}>\n          <div style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"space-between\", flexWrap: \"wrap\", gap: spacing.md }}>\n            {/* Left: Status Badges */}\n            <div style={{ display: \"flex\", alignItems: \"center\", gap: spacing.md, flexWrap: \"wrap\" }}>\n              <StatusBadge \n                ok={zerodha?.connected} \n                danger={!zerodha?.connected}\n                text={zerodha?.connected ? \"Connected\" : \"Disconnected\"} \n                icon={zerodha?.connected ? \"â—\" : \"â—‹\"}\n              />\n              <StatusBadge\n                ok={backendHealth === \"UP\" && status?.engine === \"RUNNING\"}\n                warn={backendHealth === \"BOOTING\"}\n                danger={backendHealth === \"DOWN\"}\n                text={\n                  backendHealth === \"BOOTING\"\n                    ? \"Backend Starting\"\n                    : backendHealth === \"DOWN\"\n                      ? \"Backend Down\"\n                      : status?.engine === \"RUNNING\"\n                        ? \"Engine Running\"\n                        : \"Engine Paused\"\n                }\n                icon=\"âš¡\"\n              />\n              <StatusBadge \n                ok={tradingEnabled} \n                warn={!tradingEnabled} \n                text={tradingEnabled ? \"Trading\" : \"Paused\"}\n                icon={tradingEnabled ? \"â–¶\" : \"â¸\"}\n              />\n              <StatusBadge\n                ok={executionMode === \"LIVE\"}\n                warn={executionMode === \"PAPER\"}\n                text={executionMode}\n                icon={executionMode === \"LIVE\" ? \"ðŸŸ¢\" : \"ðŸ§ª\"}\n              />\n              <StatusBadge \n                ok={inTrade} \n                warn={!inTrade} \n                text={inTrade ? \"In Trade\" : \"Armed\"}\n                icon={inTrade ? \"ðŸŽ¯\" : \"âšª\"}\n              />\n              \n              <MarketBadge name=\"NIFTY\" data={indices.NIFTY} />\n              <MarketBadge name=\"BANKNIFTY\" data={indices.BANKNIFTY} />\n            <div style={{ flex: 1 }} />\n            </div>\n\n            {/* Right: Trade Mode Selector */}\n            <div style={{ display: \"flex\", alignItems: \"center\", gap: spacing.lg, flexWrap: \"wrap\" }}>\n              <span style={{ ...typography.bodySmall, color: colors.text.muted, fontWeight: 500 }}>\n                MODE:\n              </span>\n              <div style={{ display: \"flex\", gap: 4, background: colors.bg.primary, padding: 4, borderRadius: 6 }}>\n                {[\"BOTH\", \"CE\", \"PE\"].map((mode) => (\n                  <button\n                    key={mode}\n                    onClick={async () => {\n                      setTradeSideModeState(mode);\n                      try {\n                        await setTradeSideMode(mode);\n                      } catch {}\n                    }}\n                    style={{\n                      padding: \"6px 14px\",\n                      borderRadius: 4,\n                      border: \"none\",\n                      background: tradeSideMode === mode ? colors.primary : \"transparent\",\n                      color: tradeSideMode === mode ? colors.text.primary : colors.text.tertiary,\n                      ...typography.bodySmall,\n                      fontWeight: 600,\n                      cursor: \"pointer\",\n                      transition: \"all 0.2s ease\"\n                    }}\n                    onMouseEnter={(e) => {\n                      if (tradeSideMode !== mode) {\n                        e.target.style.background = colors.bg.tertiary;\n                        e.target.style.color = colors.text.secondary;\n                      }\n                    }}\n                    onMouseLeave={(e) => {\n                      if (tradeSideMode !== mode) {\n                        e.target.style.background = \"transparent\";\n                        e.target.style.color = colors.text.tertiary;\n                      }\n                    }}\n                  >\n                    {mode === \"BOTH\" ? \"CE + PE\" : mode}\n                  </button>\n                ))}\n              </div>\n            </div>\n          </div>\n        </Card>\n      </div> \n      {/* ---------- OPTION TABLE ---------- */}\n      <div style={{ marginBottom: spacing.xxl }}>\n        <h2 style={{ ...typography.headingLarge, color: colors.text.primary, marginBottom: spacing.md }}>\n          Active Positions\n        </h2>\n\n        <Card>\n          <div style={{ overflowX: \"auto\" }}>\n            <table style={{\n              width: \"100%\",\n              borderCollapse: \"collapse\",\n              ...typography.bodyMedium,\n              tableLayout: \"fixed\"\n            }}>\n              <colgroup>\n                <col style={{ width: \"3%\" }} />\n                <col style={{ width: \"5%\" }} />\n                <col style={{ width: \"18%\" }} />\n                <col style={{ width: \"7%\" }} />\n                <col style={{ width: \"11%\" }} />\n                <col style={{ width: \"10%\" }} />\n                <col style={{ width: \"10%\" }} />\n                <col style={{ width: \"7%\" }} />\n                <col style={{ width: \"7%\" }} />\n                <col style={{ width: \"7%\" }} />\n                <col style={{ width: \"10%\" }} />\n                <col style={{ width: \"9%\" }} />\n              </colgroup>\n              <thead style={{ background: colors.bg.tertiary }}>\n                <tr>\n                  <th style={{ ...th, textAlign: \"center\" }}>#</th>\n                  <th style={{ ...th, textAlign: \"center\" }}>Side</th>\n                  <th style={{ ...th, textAlign: \"center\" }}>Symbol</th>\n                  <th style={{ ...th, textAlign: \"center\" }}>Strike</th>\n                  <th style={{ ...th, textAlign: \"center\" }}>Time</th>\n                  <th style={{ ...th, textAlign: \"center\" }}>State</th>\n                  <th style={{ ...th, textAlign: \"center\" }}>LTP</th>\n                  <th style={{ ...th, textAlign: \"center\" }}>Entry</th>\n                  <th style={{ ...th, textAlign: \"center\" }}>SL</th>\n                  <th style={{ ...th, textAlign: \"center\" }}>TP</th>\n                  <th style={{ ...th, textAlign: \"center\" }}>P&L Trend</th>\n                  <th style={{ ...th, textAlign: \"center\" }}>P&L</th>\n                </tr>\n              </thead>\n              <tbody>\n                {rows.length === 0 ? (\n                  <tr>\n                    <td colSpan=\"12\" style={{ padding: 0, border: \"none\" }}>\n                      <EmptyState\n                        icon=\"ðŸ“Š\"\n                        title=\"No active positions\"\n                        description=\"Positions will appear here once trades are executed based on your strategy settings.\"\n                      />\n                    </td>\n                  </tr>\n                ) : (\n                  rows.map((r, i) => {\n                    const slot = activeTradeBySymbol[r.tradingsymbol] || null;\n                    const state = slot ? slot.state : \"ARMED\";              \n\n                    const liveLtp = ltpMap[normalizeSymbol(r.tradingsymbol)];\n\n                    let pnl = null;\n                    if (\n                      slot &&\n                      ACTIVE_STATES.includes(slot.state) &&\n                      typeof slot.buy_price === \"number\" &&\n                      typeof liveLtp === \"number\"\n                    ) {\n                      pnl = (liveLtp - slot.buy_price) * (slot.qty || 0);\n                    }\n\n                    return (\n                      <tr \n                        key={i} \n                        style={{ \n                          background: i % 2 ? colors.bg.secondary : colors.bg.primary,\n                          transition: \"background 0.15s ease\",\n                          cursor: \"default\",\n                          borderTop: `1px solid ${colors.border.dark}`\n                        }}\n                        onMouseEnter={(e) => e.currentTarget.style.background = colors.bg.tertiary}\n                        onMouseLeave={(e) => e.currentTarget.style.background = i % 2 ? colors.bg.secondary : colors.bg.primary}\n                      >\n                        <td style={{ ...td, textAlign: \"center\" }}>\n                          <span style={{ color: colors.text.muted }}>{r.idx}</span>\n                        </td>\n                        <td style={{ ...td, textAlign: \"center\" }}>\n                          <span style={{\n                            padding: \"2px 8px\",\n                            borderRadius: 4,\n                            background: r.side === \"CE\" ? colors.successBg : colors.dangerBg,\n                            color: r.side === \"CE\" ? colors.success : colors.danger,\n                            fontSize: 11,\n                            fontWeight: 600\n                          }}>\n                            {r.side}\n                          </span>\n                        </td>\n                        <td\n                          style={{\n                            ...td,\n                            ...typography.mono,\n                            fontWeight: 600,\n                            color: colors.text.primary,\n                            whiteSpace: \"nowrap\",\n                            overflow: \"hidden\",\n                            textOverflow: \"ellipsis\",\n                            textAlign: \"center\"\n                          }}\n                          title={r.tradingsymbol}\n                        >\n                          {r.tradingsymbol}\n                        </td>\n                        <td style={{ ...td, ...typography.mono, color: colors.text.secondary, textAlign: \"center\" }}>\n                          {r.strike}\n                        </td>\n                        <td style={{ ...td, ...typography.mono, fontSize: 11, color: colors.text.tertiary, textAlign: \"center\" }}>\n                          {formatTimestamp(r.selected_at)}\n                        </td>\n                        <td style={{ ...td, textAlign: \"center\" }}>\n                          <StatusBadge\n                            ok={ACTIVE_STATES.includes(state)}\n                            warn={!ACTIVE_STATES.includes(state)}\n                            text={state}\n                          />\n                        </td>\n                        <td style={{ ...td, ...typography.mono, color: colors.text.primary, textAlign: \"center\" }}>\n                          {typeof liveLtp === \"number\" ? liveLtp.toFixed(2) : \"â€”\"}\n                        </td>\n                        <td style={{ ...td, ...typography.mono, color: colors.text.secondary, textAlign: \"center\" }}>\n                          {typeof slot?.buy_price === \"number\" ? slot.buy_price.toFixed(2) : \"â€”\"}\n                        </td>\n                        <td style={{ ...td, ...typography.mono, color: colors.text.tertiary, textAlign: \"center\" }}>\n                          {typeof slot?.sl_price === \"number\" ? slot.sl_price.toFixed(2) : \"â€”\"}\n                        </td>\n                        <td style={{ ...td, ...typography.mono, color: colors.text.tertiary, textAlign: \"center\" }}>\n                          {typeof slot?.tp_price === \"number\" ? slot.tp_price.toFixed(2) : \"â€”\"}\n                        </td>\n                        <td\n                          style={{\n                            ...td,\n                            ...typography.mono,\n                            textAlign: \"center\",\n                            ...pnlStyle(pnl),\n                            fontSize: 14,\n                            background: pnl !== null ? (\n                              pnl > 0 ? colors.profitBg :\n                              pnl < 0 ? colors.lossBg :\n                              \"transparent\"\n                            ) : \"transparent\"\n                          }}\n                        >\n                          {pnl === null ? \"â€”\" : `â‚¹${Math.round(pnl).toLocaleString('en-IN')}`}\n                        </td>\n                      </tr>\n                    );\n                  })\n                )}\n              </tbody>\n            </table>\n          </div>\n        </Card>\n      </div>\n\n      {/* ---------- TODAY'S PNL ---------- */}\n      <div>\n        <h2 style={{ ...typography.headingLarge, color: colors.text.primary, marginBottom: spacing.md }}>\n          Today's Performance\n        </h2>\n\n        <div style={{ display: \"grid\", gridTemplateColumns: \"repeat(auto-fit, minmax(300px, 1fr))\", gap: spacing.md }}>\n          {/* Summary Card */}\n          <Card elevated style={{ padding: spacing.lg }}>\n            <div style={{ ...typography.label, color: colors.text.muted, marginBottom: spacing.md }}>\n              Summary\n            </div>\n            {positionsLoading ? (\n              <CardSkeleton rows={3} />\n            ) : (\n              <div style={{ display: \"flex\", flexDirection: \"column\", gap: spacing.sm }}>\n                <PnLRow label=\"Realised\" value={positions.totals.realised} />\n                <PnLRow label=\"Unrealised\" value={positions.totals.unrealised} />\n                <div style={{ \n                  borderTop: `1px solid ${colors.border.dark}`, \n                  marginTop: spacing.sm, \n                  paddingTop: spacing.sm \n                }}>\n                  <PnLRow label=\"Total P&L\" value={positions.totals.total} large />\n                </div>\n              </div>\n            )}\n          </Card>\n\n          {/* Open Positions */}\n          <Card elevated style={{ padding: spacing.lg }}>\n            <div style={{ ...typography.label, color: colors.text.muted, marginBottom: spacing.md }}>\n              Open Positions\n            </div>\n            {positionsLoading ? (\n              <CardSkeleton rows={3} />\n            ) : (\n              <div style={{ maxHeight: 200, overflow: \"auto\" }}>\n                {positions.open.length === 0 ? (\n                  <EmptyState\n                    icon=\"ðŸ“­\"\n                    title=\"No open positions\"\n                    description=\"\"\n                  />\n                ) : (\n                  positions.open.map((p, i) => (\n                    <div \n                      key={i} \n                      style={{ \n                        ...typography.bodySmall, \n                        ...typography.mono,\n                        marginBottom: spacing.xs,\n                        padding: spacing.xs,\n                        background: colors.bg.secondary,\n                        borderRadius: 4,\n                        display: \"flex\",\n                        justifyContent: \"space-between\"\n                      }}\n                    >\n                      <span style={{ color: colors.text.secondary }}>\n                        {p.tradingsymbol} Ã— {p.quantity}\n                      </span>\n                      <span style={pnlStyle(safeNum(p.pnl))}>\n                        â‚¹{Math.round(safeNum(p.pnl)).toLocaleString('en-IN')}\n                      </span>\n                    </div>\n                  ))\n                )}\n              </div>\n            )}\n          </Card>\n\n          {/* Closed Positions */}\n          <Card elevated style={{ padding: spacing.lg }}>\n            <div style={{ ...typography.label, color: colors.text.muted, marginBottom: spacing.md }}>\n              Closed Positions\n            </div>\n            {positionsLoading ? (\n              <CardSkeleton rows={3} />\n            ) : (\n              <div style={{ maxHeight: 200, overflow: \"auto\" }}>\n                {positions.closed.length === 0 ? (\n                  <EmptyState\n                    icon=\"ðŸ“­\"\n                    title=\"No closed positions\"\n                    description=\"\"\n                  />\n                ) : (\n                  positions.closed.map((p, i) => (\n                    <div \n                      key={i} \n                      style={{ \n                        ...typography.bodySmall,\n                        ...typography.mono,\n                        marginBottom: spacing.xs,\n                        padding: spacing.xs,\n                        background: colors.bg.secondary,\n                        borderRadius: 4,\n                        display: \"flex\",\n                        justifyContent: \"space-between\"\n                      }}\n                    >\n                      <span style={{ color: colors.text.secondary }}>\n                        {p.tradingsymbol} Ã— {p.day_buy_quantity}\n                      </span>\n                      <span style={pnlStyle(safeNum(p.pnl))}>\n                        â‚¹{Math.round(safeNum(p.pnl)).toLocaleString('en-IN')}\n                      </span>\n                    </div>\n                  ))\n                )}\n              </div>\n            )}\n          </Card>\n        </div>\n      </div>\n\n      {/* ---------- DEBUG ---------- */}\n      <div style={{ marginTop: spacing.xxl }}>\n        <DebugPanel rows={rows} />\n      </div>\n    </div>\n  );\n}\n\n/* ----------------------------------\n   Helper Components\n----------------------------------- */\n\nfunction PnLRow({ label, value, large }) {\n  return (\n    <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n      <span style={{ \n        ...(large ? typography.bodyLarge : typography.bodyMedium), \n        color: colors.text.secondary,\n        fontWeight: large ? 600 : 400\n      }}>\n        {label}\n      </span>\n      <span style={{ \n        ...(large ? typography.headingMedium : typography.bodyMedium),\n        ...typography.mono,\n        ...pnlStyle(value)\n      }}>\n        â‚¹{Math.round(value).toLocaleString('en-IN')}\n      </span>\n    </div>\n  );\n}\n\nfunction MarketBadge({ name, data }) {\n  const [pulse, setPulse] = useState(false);\n  const prevLtpRef = useRef(null);\n\n  const ltp =\n    typeof data?.ltp === \"number\" ? data.ltp : null;\n\n  const prevClose =\n    typeof data?.prev_close === \"number\" ? data.prev_close : ltp;\n\n  // âœ… Hooks ALWAYS run\n  useEffect(() => {\n    if (ltp === null) return;\n\n    if (prevLtpRef.current !== null && prevLtpRef.current !== ltp) {\n      setPulse(true);\n      const t = setTimeout(() => setPulse(false), 180);\n      return () => clearTimeout(t);\n    }\n\n    prevLtpRef.current = ltp;\n  }, [ltp]);\n\n  \n  // âœ… Conditional render AFTER hooks\n  if (ltp === null || prevClose === null) {\n    return null;\n  }\n\n  const change = ltp - prevClose;\n  const pct = prevClose !== 0 ? (change / prevClose) * 100 : 0;\n  const up = change >= 0;\n\n  const bg = up ? colors.successBg : colors.dangerBg;\n  const color = up ? colors.success : colors.danger;\n\n  return (\n    <span\n      style={{\n        display: \"inline-flex\",\n        alignItems: \"center\",\n        gap: 8,\n        padding: \"6px 12px\",\n        minHeight: 28,\n        borderRadius: 6,\n        background: bg,\n        color,\n        border: `1px solid ${color}40`,\n        fontSize: 11,\n        fontWeight: 600,\n        letterSpacing: \"0.3px\",\n        textTransform: \"uppercase\",\n        filter: pulse ? \"brightness(1.25)\" : \"brightness(1)\",\n        boxShadow: pulse ? `0 0 8px ${color}55` : \"none\",\n        transition: \"filter 0.18s ease, box-shadow 0.18s ease\"\n      }}\n    >\n      <span style={{ opacity: 0.9 }}>{name}</span>\n\n      <span style={{ ...typography.mono, fontSize: 12 }}>\n        {ltp.toFixed(2)}\n      </span>\n\n      <span style={{ ...typography.mono, fontSize: 11 }}>\n        {up ? \"â–²\" : \"â–¼\"} {pct.toFixed(2)}%\n      </span>\n    </span>\n  );\n}\n\n\n/* ----------------------------------\n   Styles\n----------------------------------- */\n\nconst th = {\n  padding: \"12px 12px\",\n  textAlign: \"left\",\n  ...typography.label,\n  color: colors.text.muted,\n  borderBottom: `2px solid ${colors.border.light}`,\n  fontWeight: 600\n};\n\nconst td = { \n  padding: \"12px 12px\",\n  ...typography.bodyMedium\n};\n\nconst styles = `\n  @keyframes loading {\n    0% { transform: translateX(-100%); }\n    100% { transform: translateX(400%); }\n  }\n`;\n\nif (typeof document !== 'undefined' && !document.getElementById('dashboard-styles')) {\n  const styleSheet = document.createElement('style');\n  styleSheet.id = 'dashboard-styles';\n  styleSheet.textContent = styles;\n  document.head.appendChild(styleSheet);\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}